<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Passagem de Serviço</title>
  <link rel="stylesheet" href="/static/css/styles.css?v=2" />
</head>

<body>
  <header class="app-header">
    <img src="/static/assets/logo.png" class="logo" alt="logo" />
    <div class="titles">
      <h1>SIRF-MIS PASSAGEM DE SERVIÇO</h1>
      <small id="subTitle">Fiscalização SUB/OPSUB/MIS</small>
    </div>
    <div class="userbox">
      <div class="user-info">
        <span id="userName" class="tag"></span>
        <span id="userProfile" class="profile-admin" style="display:none;">ADMINISTRADOR</span>
      </div>
    </div>
  </header>

  <nav class="topnav">
    <button class="tablink" id="volta_ps" onclick="window.location.href='/'">⬅ Voltar</button>
    <button class="tablink active" data-tab="consultas">Inicio PS</button>
  </nav>

  <main>
    <section id="tab-consultas" class="tab active">
      <div class="filters fadein">
        <div class="field"><label>Início</label><input type="date" id="fInicio"></div>
        <div class="field"><label>Fim</label><input type="date" id="fFim"></div>
        <button id="btnBuscar" class="btn">Buscar</button>
        <button id="btnNova" class="btn secondary">Nova PS</button>
        <span id="msgNovaPS" class="msg-erro"></span>
      </div>
      <div class="list-container fadein">
        <ul id="listaPS"></ul>
      </div>
    </section>

    <section id="tab-passagem" class="tab">
      <div id="psPlaceholder" class="placeholder">MÓDULO PASSAGEM DE SERVIÇO</div>
      <div id="psForm" class="psform hidden">
        <div class="ps-header card fadein">
          <div class="row">
            <div class="col"><label>Número PS</label><input type="text" id="fNumero"></div>
            <div class="col"><label>Data Emissão</label><input type="date" id="fData"></div>
            <div class="col"><label>Embarcação</label><input type="text" id="fEmb"></div>
          </div>
          <div class="row">
            <div class="col"><label>Inicio Quinzena</label><input type="date" id="fInicioPS"></div>
            <div class="col"><label>Fim Quinzena</label><input type="date" id="fFimPS"></div>
            <div class="col"><label>Status da PS</label><input type="text" id="fStatus" disabled></div>
          </div>
          <div class="row">
            <div class="col"><label>Fiscal Embarcando</label><select id="fEmbC">
                <option value="">— selecione —</option>
              </select></div>
            <div class="col"><label>Fiscal Desembarcando</label><input type="text" id="fDesCNome"
                placeholder="Seu nome completo"></div>
            <div class="col"><label>&nbsp;</label></div>
          </div>
          <div class="btns">
            <button id="btnSalvar" class="btn">Salva rascunho</button>
            <button id="btnFinalizar" class="btn">Finalizar (PDF)</button>
            <button id="btnExcluirRasc" class="btn secondary">Excluir rascunho</button>
          </div>
        </div>

        <div class="tabs-sub">
          <button class="sublink active" data-sub="porto">1. Porto</button>
          <button class="sublink" data-sub="pendencias">2. Pendências, Ocorrências e Orientações</button>
          <button class="sublink" data-sub="lvsms">3. Listas de Verificação-SMS</button>
          <button class="sublink" data-sub="os">4. Ordens de Serviço</button>
          <button class="sublink" data-sub="gerais">5. Orientações e Informações Gerais</button>
        </div>

        <div class="subtab active" id="sub-porto">
          <div class="card">
            <h2>1. PORTO</h2>
          </div>

          <!-- 1.1 Troca de Turma -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="trocaturma">
              <span>1.1 TROCA DE TURMA</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-trocaturma">
              <div class="col">
                <div style="display:flex; gap:12px; align-items:flex-start;">
                  <div style="flex:0 0 auto;">
                    <label>Porto *</label><input id="ttPorto" type="text" maxlength="100" style="width:400px;">
                  </div>
                  <div style="flex:0 0 auto;">
                    <label>Terminal *</label><input id="ttTerminal" type="text" maxlength="100" style="width:400px;">
                  </div>
                </div>
                <label>OS *</label><input id="ttOS" type="text" maxlength="50" style="width:160px;">
                <div style="display:flex; gap:12px; align-items:flex-start;">
                  <div style="flex:0 0 auto;">
                    <label>Atracação (hh:mm) *</label><input width="100" id="ttAtracacao" type="time"
                      style="width:100px;">
                  </div>
                  <div style="flex:0 0 auto;">
                    <label>Duração *</label><input id="ttDuracao" type="number" step="1" min="0" style="width:100px;">
                  </div>
                </div>
                <label>Observações</label><textarea id="ttObs" maxlength="4000" rows="8"
                  style="width:100%;resize:vertical;overflow:auto;"></textarea>
              </div>
            </div>
          </div>

          <!-- 1.2 Manutenção Preventiva -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="manutprev">
              <span>1.2 MANUTENÇÃO PREVENTIVA</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-manutprev">
              <div class="col">
                <label style="display:inline-flex;align-items:center;gap:6px;white-space:nowrap;margin-bottom:8px;">
                  <input id="mpNaoPrevisto" type="checkbox">
                  Não previsto para esse porto
                </label>

                <div id="containerCamposManutPrev" style="display:block;">
                  <div style="display:flex; gap:12px; align-items:flex-start;">
                    <div style="flex:0 0 auto;">
                      <label>Franquia solicitada (min)</label><input id="mpFranquia" type="number" step="1" min="0"
                        style="width:160px;">
                    </div>
                    <div style="flex:0 0 auto;">
                      <label>Saldo de franquia (min)</label> <input id="mpSaldo" type="number" step="1" min="0"
                        style="width:160px;">
                    </div>
                  </div>

                  <label>OS</label><input id="mpOS" type="text" maxlength="50" style="width:160px;">

                  <label>RADE (anexo)</label>
                  <div style="display:flex; align-items:center; gap:10px;">
                    <input id="mpRADE" type="file" style="width:400px" accept="application/pdf,image/*">
                    <span id="linkDownloadRade"></span>
                  </div>

                  <label>Observações</label><textarea id="mpObs" maxlength="4000" rows="8"
                    style="width:100%;resize:vertical;overflow:auto;"></textarea>
                </div>
              </div>
            </div>
          </div>

          <!-- 1.3 Abastecimento -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="abastecimento">
              <span>1.3 ABASTECIMENTO DE DIESEL</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-abastecimento">
              <div class="col">
                <label style="display:inline-flex;align-items:center;gap:6px;white-space:nowrap;margin-bottom:8px;">
                  <input id="abNaoPrevisto" type="checkbox"> Não previsto para esse porto
                </label>

                <div id="containerCamposAbast" style="display:block;">
                  <label>OS</label><input id="abOS" type="text" maxlength="50" style="width:160px;">

                  <div style="display:flex; gap:12px; align-items:flex-start;">
                    <div style="flex:0 0 auto;">
                      <label>Data</label>
                      <input type="date" id="prevInicioAbast" style="width:200px;">
                    </div>

                    <div style="flex:0 0 auto;">
                      <label>Qtde. M³</label><input id="abQtd" type="number" step="1" min="0" style="width:100px;">
                    </div>

                    <div style="flex:0 0 auto;">
                      <label>Duração Prevista (h)</label><input id="abDuracao" type="number" step="1" min="0"
                        style="width:100px;">
                    </div>
                  </div>

                  <div style="display:flex; gap:12px; align-items:flex-start;">
                    <div style="flex:0 0 auto;">
                      <label>Último Abastecimento</label><input type="date" id="ultimoAbast" style="width:180px;"
                        disabled>
                    </div>

                    <div style="flex:0 0 auto;">
                      <label>Qtde. M³</label>
                      <input id="ultAbastQtd" type="number" step="1" min="0" style="width:100px;" disabled>
                      <span id="msgUltAbast"></span>
                    </div>
                  </div>

                  <label>Anexo</label>
                  <div style="display:flex; align-items:center; gap:10px;">
                    <input id="abAnexo" type="file" style="width:400px" accept="application/pdf,image/*">
                    <span id="linkDownloadAbast"></span>
                  </div>

                  <label>Observações</label>
                  <textarea id="abObs" maxlength="4000" rows="8"
                    style="width:100%;resize:vertical;overflow:auto;"></textarea>
                </div>
              </div>
            </div>
          </div>

          <!-- 1.4 Inspeção Normativa -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="anvisa">
              <span>1.4 INSPEÇÕES NORMATIVAS</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-anvisa">
              <div class="col">
                <label style="display:inline-flex;align-items:center;gap:6px;white-space:nowrap;margin-bottom:8px;">
                  <input id="anNaoPrevisto" type="checkbox"> Não previsto para esse porto
                </label>

                <div id="containerSubtabelaInspNorm" style="display:block;">
                  <div style="display:flex; gap:12px; align-items:flex-start; margin-bottom:12px;">
                    <div style="flex:0 0 auto;">
                      <label>Descrição</label><select id="inspNorDesc" style="width:200px;">
                        <option value="">— selecione —</option>
                      </select>
                    </div>
                    <div style="flex:0 0 auto;">
                      <label>OS</label><input id="inspNorOS" type="text" maxlength="50" style="width:160px;">
                    </div>
                    <div style="flex:0 0 auto; margin-top:20px;">
                      <button id="btnAddInspNorm" class="btn small">Adicionar</button>
                    </div>
                  </div>

                  <table id="tblInspNorm" style="width:100%; border-collapse:collapse; margin-bottom:12px;">
                    <thead>
                      <tr style="background:#f0f0f0;">
                        <th style="border:1px solid #ddd; padding:8px; text-align:left;">Descrição</th>
                        <th style="border:1px solid #ddd; padding:8px; text-align:left;">OS</th>
                        <th style="border:1px solid #ddd; padding:8px; text-align:center; width:100px;">Ações</th>
                      </tr>
                    </thead>
                    <tbody>
                    </tbody>
                  </table>
                </div>

                <label>Observações</label>
                <textarea id="anObs" maxlength="4000" rows="8"
                  style="width:100%;resize:vertical;overflow:auto;"></textarea>
              </div>
            </div>
          </div>

          <!-- 1.5 Inspeções/Auditorias Petrobras -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="petrobras">
              <span>1.5 INSPEÇÕES/AUDITORIAS PETROBRAS</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-petrobras">
              <div class="col">
                <label style="display:inline-flex;align-items:center;gap:6px;white-space:nowrap;margin-bottom:8px;">
                  <input id="ipNaoPrevisto" type="checkbox"> Não previsto para esse porto
                </label>

                <div id="containerSubtabelaInspPetr" style="display:block;">
                  <div style="display:flex; gap:12px; align-items:flex-start; margin-bottom:12px;">
                    <div style="flex:0 0 auto;">
                      <label>Descrição</label>
                      <select id="inspPetrDesc" style="width:200px;">
                        <option value="">— selecione —</option>
                      </select>
                    </div>
                    <div style="flex:0 0 auto;">
                      <label>Auditor/Visitante</label>
                      <input id="ipAud" type="text" maxlength="30" style="width:250px;">
                    </div>
                    <div style="flex:0 0 auto;">
                      <label>Gerência</label>
                      <input id="ipGer" type="text" maxlength="30" style="width:250px;">
                    </div>
                    <div style="flex:0 0 auto; margin-top:20px;">
                      <button id="btnAddInspPetr" class="btn small">Adicionar</button>
                    </div>
                  </div>

                  <table id="tblInspPetr" style="width:100%; border-collapse:collapse; margin-bottom:12px;">
                    <thead>
                      <tr style="background:#f0f0f0;">
                        <th style="border:1px solid #ddd; padding:8px; text-align:left;">Descrição</th>
                        <th style="border:1px solid #ddd; padding:8px; text-align:left;">Auditor/Visitante</th>
                        <th style="border:1px solid #ddd; padding:8px; text-align:left;">Gerência</th>
                        <th style="border:1px solid #ddd; padding:8px; text-align:center; width:100px;">Ações</th>
                      </tr>
                    </thead>
                    <tbody>
                    </tbody>
                  </table>
                </div>

                <label>Observações</label>
                <textarea id="ipObs" maxlength="4000" rows="8"
                  style="width:100%;resize:vertical;overflow:auto;"></textarea>
              </div>
            </div>
          </div>

          <!-- 1.6 Embarque de Equipes -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="embequipes">
              <span>1.6 EMBARQUE DE EQUIPES</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-embequipes">
              <div class="col">
                <label style="display:inline-flex;align-items:center;gap:6px;white-space:nowrap;margin-bottom:8px;">
                  <input id="eqNaoPrevisto" type="checkbox"> Não previsto para esse porto
                </label>

                <div id="containerSubtabelaEmbEquip" style="display:block;">
                  <div style="display:flex; gap:12px; align-items:flex-start; margin-bottom:12px;">
                    <div style="flex:0 0 auto;">
                      <label>Descrição</label>
                      <select id="embEquipDesc" style="width:200px;">
                        <option value="">— selecione —</option>
                      </select>
                    </div>
                    <div style="flex:0 0 auto;">
                      <label>Nome</label>
                      <input id="eqNome" type="text" maxlength="30" style="width:250px;">
                    </div>
                    <div style="flex:0 0 auto;">
                      <label>Função</label>
                      <input id="eqFuncao" type="text" maxlength="30" style="width:250px;">
                    </div>
                    <div style="flex:0 0 auto;">
                      <label>Empresa</label>
                      <input id="eqEmpresa" type="text" maxlength="30" style="width:250px;">
                    </div>
                    <div style="flex:0 0 auto; margin-top:20px;">
                      <button id="btnAddEmbEquip" class="btn small">Adicionar</button>
                    </div>
                  </div>

                  <table id="tblEmbEquip" style="width:100%; border-collapse:collapse; margin-bottom:12px;">
                    <thead>
                      <tr style="background:#f0f0f0;">
                        <th style="border:1px solid #ddd; padding:8px; text-align:left;">Descrição</th>
                        <th style="border:1px solid #ddd; padding:8px; text-align:left;">Nome</th>
                        <th style="border:1px solid #ddd; padding:8px; text-align:left;">Função</th>
                        <th style="border:1px solid #ddd; padding:8px; text-align:left;">Empresa</th>
                        <th style="border:1px solid #ddd; padding:8px; text-align:center; width:100px;">Ações</th>
                      </tr>
                    </thead>
                    <tbody>
                    </tbody>
                  </table>
                </div>

                <label>Observações</label>
                <textarea id="eqObs" maxlength="4000" rows="8"
                  style="width:100%;resize:vertical;overflow:auto;"></textarea>
              </div>
            </div>
          </div>

          <!-- 1.7 OS Mobilização/Desmobilização -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="osmobdesm">
              <span>1.7 OS's DE MOBILIZAÇÃO/DESMOBILIZAÇÃO</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-osmobdesm">
              <div class="col">
                <label style="display:inline-flex;align-items:center;gap:6px;white-space:nowrap;margin-bottom:8px;">
                  <input id="omNaoPrevisto" type="checkbox"> Não previsto para esse porto
                </label>

                <div id="containerSubtabelaMobD" style="display:block;">
                  <div style="display:flex; gap:12px; align-items:flex-start; margin-bottom:12px;">
                    <div style="flex:0 0 auto;">
                      <label>OS</label>
                      <input id="mobDOS" type="text" maxlength="12" style="width:160px;">
                    </div>
                    <div style="flex:0 0 auto;">
                      <label>Descrição</label>
                      <input id="mobDDesc" type="text" maxlength="300" style="width:400px;">
                    </div>
                    <div style="flex:0 0 auto; margin-top:20px;">
                      <button id="btnAddMobD" class="btn small">Adicionar</button>
                    </div>
                  </div>

                  <table id="tblMobD" style="width:100%; border-collapse:collapse; margin-bottom:12px;">
                    <thead>
                      <tr style="background:#f0f0f0;">
                        <th style="border:1px solid #ddd; padding:8px; text-align:left;">OS</th>
                        <th style="border:1px solid #ddd; padding:8px; text-align:left;">Descrição</th>
                        <th style="border:1px solid #ddd; padding:8px; text-align:center; width:100px;">Ações</th>
                      </tr>
                    </thead>
                    <tbody>
                    </tbody>
                  </table>
                </div>

                <label>Observações</label>
                <textarea id="omObs" maxlength="4000" rows="8"
                  style="width:100%;resize:vertical;overflow:auto;"></textarea>
              </div>
            </div>
          </div>

          <!-- 1.8 Embarque de Materiais -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="embmateriais">
              <span>1.8 PROGRAMAÇÃO DE EMBARQUE DE MATERIAIS</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-embmateriais">
              <div class="col">

                <table id="tblEmbMatPs" style="width:100%; text-align:center;">
                  <thead>
                    <tr>
                      <th>Descrição do Material</th>
                      <th>Numero da RT</th>
                      <th>Ordem de Serviço</th>
                      <th>Responsável</th>
                      <th>Descrição do contentor</th>
                      <th style="width:150px;">Ações</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td colspan="6" style="text-align:center; color:#999;">Nenhum material programado para embarque
                      </td>
                    </tr>
                  </tbody>
                </table>

              </div>
            </div>
          </div>

          <!-- 1.9 Desembarque de Materiais -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="desmateriais">
              <span>1.9 SOLICITAÇÕES DE DESEMBARQUE DE MATERIAIS</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-desmateriais">
              <div class="col">

                <table id="tblDesMatPs" style="width:100%; text-align:center;">
                  <thead>
                    <tr>
                      <th>Descrição do Material</th>
                      <th>Responsável</th>
                      <th>Descrição do contentor</th>
                      <th>Status</th>
                      <th style="width:150px;">Ações</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td colspan="5" style="text-align:center; color:#999;">Nenhum material solicitado para desembarque
                      </td>
                    </tr>
                  </tbody>
                </table>

              </div>
            </div>
          </div>

        </div><!--Fim da subtab PORTO-->


        <!-- templates/index_ps.html -->
        <!-- TRECHO A SER INSERIDO APÓS O FECHAMENTO DA DIV sub-porto -->

        <!-- ==================== SUB-ABA 2: PENDÊNCIAS, OCORRÊNCIAS E ORIENTAÇÕES ==================== -->
        <div class="subtab" id="sub-pendencias">
          <div class="card">
            <h2>2. PENDÊNCIAS, OCORRÊNCIAS E ORIENTAÇÕES</h2>
          </div>

          <!-- 2.1 Assuntos e Pendências Contratuais -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="assunpendcontr">
              <span>2.1 ASSUNTOS CONTRATUAIS</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-assunpendcontr">
              <!-- SUBSTITUIR O CONTEÚDO DENTRO DE: <div class="accordion-content" id="acc-assunpendcontr"> -->

              <div class="col" style="position:relative;">
                <!-- Botão Cadastro no canto superior direito -->
                <button id="btnCadastroAssunPend" class="btn"
                  style="position:absolute; top:0; right:0;">CADASTRO</button>

                <p style="margin-bottom:16px; color:#666;">Gestão de assuntos e pendências contratuais.</p>

                <!-- Tabela de Registros -->
                <table id="tblAssunPendContr" style="width:100%; border-collapse:collapse; margin-bottom:12px;">
                  <thead>
                    <tr style="background:#f0f0f0;">
                      <th style="border:1px solid #ddd; padding:8px; text-align:left; width:120px;">Item</th>
                      <th style="border:1px solid #ddd; padding:8px; text-align:left;">Descrição</th>
                      <th style="border:1px solid #ddd; padding:8px; text-align:center; width:280px;">Ações</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Registros serão inseridos via JavaScript -->
                  </tbody>
                </table>

                <div id="msgSemRegistros" style="display:none; padding:20px; text-align:center; color:#666;">
                  Nenhum registro encontrado.
                </div>
              </div>

              <!-- MODAL DE CADASTRO PRINCIPAL -->
              <div id="modalCadastroAssunPend" class="modal-overlay">
                <div class="modal-content" style="max-width:800px;">
                  <div class="modal-header">
                    <h2 style="margin:0;">ASSUNTOS E PENDÊNCIAS CONTRATUAIS</h2>
                    <button class="modal-close" onclick="AssunPendContrModule.fecharModalCadastro()">&times;</button>
                  </div>
                  <div class="modal-body">

                    <!-- CRUD: Select -->
                    <div class="col" style="margin-bottom:20px;">
                      <label>Selecionar Registro Existente</label>
                      <select id="apcSelectCrud" style="width:100%;">
                        <option value="">— selecione —</option>
                      </select>
                    </div>

                    <hr style="margin:20px 0; border:none; border-top:1px solid #ddd;">

                    <!-- Campos do Formulário -->
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px; margin-bottom:16px;">
                      <div class="col">
                        <label>Data</label>
                        <input id="apcData" type="date" style="width:100%;">
                      </div>
                      <div class="col">
                        <label>Registrado por</label>
                        <select id="apcFiscal" style="width:100%;">
                          <option value="">— selecione —</option>
                        </select>
                      </div>
                    </div>

                    <div class="col" style="margin-bottom:16px;">
                      <label>Classificação Registro</label>
                      <select id="apcClasse" style="width:100%;">
                        <option value="">— selecione —</option>
                        <option value="PENDENCIA DE ACEITAÇÃO">PENDENCIA DE ACEITAÇÃO</option>
                        <option value="ITENS CONTRATUAIS">ITENS CONTRATUAIS</option>
                        <option value="OUTROS">OUTROS</option>
                      </select>
                    </div>
                    <!-- CAMPOS CONTRATUAIS -->
                    <div class="col" style="margin-bottom:16px;">
                      <label>Contrato</label>
                      <select id="apcContrato" style="width:100%;">
                        <option value="">— selecione —</option>
                      </select>
                    </div>

                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px; margin-bottom:16px;">
                      <div class="col">
                        <label>Item Contratual</label>
                        <input id="apcItemContr" type="text" maxlength="20" style="width:100%;"
                          placeholder="Ex: 5.1.2 alinea a">
                      </div>
                      <div class="col">
                        <label>Anexo Contratual</label>
                        <input id="apcAnexoContr" type="text" maxlength="30" style="width:100%;"
                          placeholder="Ex: Anexo II-A">
                      </div>
                    </div>
                    <!-- CAMPOS BROA -->
                    <div style="display:grid; grid-template-columns:200px 1fr; gap:16px; margin-bottom:16px;">
                      <div class="col">
                        <label style="display:flex; align-items:center; gap:8px;">
                          <input id="apcAbertoBroa" type="checkbox" style="width:auto;">
                          Abertura de BROA?
                        </label>
                      </div>
                      <div class="col" id="divNumeroBroa" style="display:none;">
                        <label>Número do BROA</label>
                        <input id="apcNumeroBroa" type="text" maxlength="20" style="width:100%;"
                          placeholder="Ex: 2025/001">
                      </div>
                    </div>
                    <!-- FIM CAMPOS BROA -->

                    <div class="col" style="margin-bottom:20px;">
                      <label>Descrição do Novo Registro</label>
                      <textarea id="apcDescricao" maxlength="400" rows="6"
                        style="width:100%; resize:vertical;"></textarea>
                      <div style="font-size:12px; color:#666; margin-top:4px;">Máximo 400 caracteres</div>
                    </div>

                    <!-- Botões de Ação -->
                    <div style="display:flex; gap:12px; justify-content:flex-end;">
                      <button id="btnApcSalvar" class="btn">Salvar Novo</button>
                      <button id="btnApcEditar" class="btn secondary" disabled>Editar</button>
                      <button id="btnApcExcluir" class="btn ghost" disabled>Excluir</button>
                      <button class="btn ghost" onclick="AssunPendContrModule.fecharModalCadastro()">Fechar</button>
                    </div>

                  </div>
                </div>
              </div>

              <!-- MODAL DE COMENTÁRIO -->
              <div id="modalComentarioAssunPend" class="modal-overlay">
                <div class="modal-content" style="max-width:700px;">
                  <div class="modal-header">
                    <h2 style="margin:0;">ADICIONAR COMENTÁRIO</h2>
                    <button class="modal-close" onclick="AssunPendContrModule.fecharModalComentario()">&times;</button>
                  </div>
                  <div class="modal-body">

                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px; margin-bottom:16px;">
                      <div class="col">
                        <label>Data</label>
                        <input id="apcComentData" type="date" style="width:100%;">
                      </div>
                      <div class="col">
                        <label>Registrado por</label>
                        <select id="apcComentFiscal" style="width:100%;">
                          <option value="">— selecione —</option>
                        </select>
                      </div>
                    </div>

                    <div class="col" style="margin-bottom:20px;">
                      <label>Descrição do Comentário</label>
                      <textarea id="apcComentDescricao" maxlength="400" rows="6"
                        style="width:100%; resize:vertical;"></textarea>
                      <div style="font-size:12px; color:#666; margin-top:4px;">Máximo 400 caracteres</div>
                    </div>

                    <!-- Botões de Ação -->
                    <div style="display:flex; gap:12px; justify-content:flex-end;">
                      <button id="btnApcComentSalvar" class="btn">Salvar Comentário</button>
                      <button class="btn ghost" onclick="AssunPendContrModule.fecharModalComentario()">Cancelar</button>
                    </div>

                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 2.2 Desvios e Não Conformidades -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="desvnaoconf">
              <span>2.2 DESVIOS E NÃO CONFORMIDADES</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-desvnaoconf">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Registro de desvios e não conformidades.</p>
                <!-- IMPLEMENTAÇÃO FUTURA -->
              </div>
            </div>
          </div>

          <!-- 2.3 Informes de Anomalia Emitidos -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="anomsms">
              <span>2.3 INFORMES DE ANOMALIA EMITIDOS</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-anomsms">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Informes de anomalia emitidos na quinzena.</p>

                <table id="tblAnomSMS" style="width:100%; border-collapse:collapse; margin-bottom:12px;">
                  <thead>
                    <tr style="background:#f0f0f0;">
                      <th style="border:1px solid #ddd; padding:8px; text-align:center; width:90px;">Data</th>
                      <th style="border:1px solid #ddd; padding:8px; text-align:center; width:70px;">Hora</th>
                      <th style="border:1px solid #ddd; padding:8px; text-align:left; width:150px;">Referente a</th>
                      <th style="border:1px solid #ddd; padding:8px; text-align:left;">Descrição</th>
                      <th style="border:1px solid #ddd; padding:8px; text-align:center; width:120px;">Visualizar</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>

                <div id="msgSemAnomalias" style="display:none; padding:20px; text-align:center; color:#666;">
                  Nenhuma anomalia registrada nesta quinzena.
                </div>
              </div>
            </div>
          </div>

          <!-- 2.4 FROs Emitidos -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="frosemitidos">
              <span>2.4 EMISSÃO DE FRO</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-frosemitidos">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Formulários de Registro de Ocorrências emitidos.</p>
                <!-- IMPLEMENTAÇÃO FUTURA -->
              </div>
            </div>
          </div>

          <!-- 2.5 Pendências BROA -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="pendbroa">
              <span>2.5 PENDENCIAS BROA</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-pendbroa">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Pendências registradas no BROA.</p>
                <!-- IMPLEMENTAÇÃO FUTURA -->
              </div>
            </div>
          </div>

        </div><!--Fim da subtab PENDÊNCIAS-->


        <!-- ==================== SUB-ABA 3: LISTAS DE VERIFICAÇÃO-SMS ==================== -->
        <div class="subtab" id="sub-lvsms">
          <div class="card">
            <h2>3. LISTAS DE VERIFICAÇÃO-SMS</h2>
          </div>

          <!-- 3.1 LV Sob Demanda -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="lvsobdemanda">
              <span>3.1 LV SOB DEMANDA</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-lvsobdemanda">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Listas de Verificação Sob Demanda.</p>
                <!-- IMPLEMENTAÇÃO FUTURA -->
              </div>
            </div>
          </div>

          <!-- 3.2 LV de Segurança -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="lvseguranca">
              <span>3.2 LV SEGURANÇA</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-lvseguranca">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Lista de Verificação de Segurança.</p>
                <!-- IMPLEMENTAÇÃO FUTURA -->
              </div>
            </div>
          </div>

          <!-- 3.3 LV de Mangueiras -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="lvmangueiras">
              <span>3.3 LV DE MANGUEIRAS</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-lvmangueiras">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Lista de Verificação de Mangueiras.</p>
                <!-- IMPLEMENTAÇÃO FUTURA -->
              </div>
            </div>
          </div>
          <!-- 3.4 LV de Pré-Abastecimento -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="lvpreabast">
              <span>3.4 LV PRÉ-ABASTECIMENTO</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-lvpreabast">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Lista de Verificação de Pré-Abastecimento.</p>
                <!-- IMPLEMENTAÇÃO FUTURA -->
              </div>
            </div>
          </div>




          <!-- 3.3 LV Segurança Durante Operações de Mergulho (CONDICIONAL) -->
          <div class="accordion-item accordion-item-hidden" data-tipo-barco="TUP,DSV,SDSV">
            <div class="accordion-header" data-target="lvsegopmerg">
              <span>3.5 LV SEGURANÇA DE OPERAÇÕES DE MERGULHO</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-lvsegopmerg">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Lista de Verificação de Segurança Durante Operações de
                  Mergulho.</p>
                <!-- IMPLEMENTAÇÃO FUTURA -->
              </div>
            </div>
          </div>

          <!-- 3.4 LV de Operações Críticas de Mergulho (CONDICIONAL) -->
          <div class="accordion-item accordion-item-hidden" data-tipo-barco="TUP,DSV,SDSV">
            <div class="accordion-header" data-target="lvopcriticamerg">
              <span>3.6 LV OPERAÇÕES CRÍTICAS DE MERGULHO</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-lvopcriticamerg">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Lista de Verificação de Operações Críticas de Mergulho.</p>
                <!-- IMPLEMENTAÇÃO FUTURA -->
              </div>
            </div>
          </div>

          <!-- 3.5 LV de Conformidade com Requisitos de Mergulho (CONDICIONAL) -->
          <div class="accordion-item accordion-item-hidden" data-tipo-barco="TUP,DSV,SDSV">
            <div class="accordion-header" data-target="lvconfreqmerg">
              <span>3.7 LV CONFORMIDADE DE REQUISITOS DE MERGULHO</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-lvconfreqmerg">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Lista de Verificação de Conformidade com Requisitos de
                  Mergulho.</p>
                <!-- IMPLEMENTAÇÃO FUTURA -->
              </div>
            </div>
          </div>

          <!-- 3.6 LV de LDB (CONDICIONAL) -->
          <div class="accordion-item accordion-item-hidden" data-tipo-barco="TUP,DSV,SDSV">
            <div class="accordion-header" data-target="lvldb">
              <span>3.8 LV DE LDB</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-lvldb">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Lista de Verificação de LDB.</p>
                <!-- IMPLEMENTAÇÃO FUTURA -->
              </div>
            </div>
          </div>

          <!-- 3.7 LV de Enfermaria (CONDICIONAL) -->
          <div class="accordion-item accordion-item-hidden" data-tipo-barco="TUP,DSV,SDSV">
            <div class="accordion-header" data-target="lvenfermaria">
              <span>3.9 LV DE ENFERMARIA</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-lvenfermaria">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Lista de Verificação de Enfermaria.</p>
                <!-- IMPLEMENTAÇÃO FUTURA -->
              </div>
            </div>
          </div>


        </div><!--Fim da subtab LISTAS DE VERIFICAÇÃO-->


        <!-- ==================== SUB-ABA 4: ORDENS DE SERVIÇO ==================== -->
        <div class="subtab" id="sub-os">
          <div class="card">
            <h2>4. ORDENS DE SERVIÇO</h2>
          </div>

          <!-- 4.1 OS Programadas -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="osprogramadas">
              <span>4.1 OS's PROGRAMADAS</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-osprogramadas">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Ordens de Serviço Programadas.</p>
                <!-- IMPLEMENTAÇÃO FUTURA -->
              </div>
            </div>
          </div>

          <!-- 4.2 OS Interrompidas -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="osinterrompidas">
              <span>4.2 OS's INTERROMPIDAS</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-osinterrompidas">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Ordens de Serviço Interrompidas.</p>
                <!-- IMPLEMENTAÇÃO FUTURA -->
              </div>
            </div>
          </div>

          <!-- 4.3 IAPO -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="iapo">
              <span>4.3 IAPO</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-iapo">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Informativo de Atualização do Plano Operacional.</p>
                <!-- IMPLEMENTAÇÃO FUTURA -->
              </div>
            </div>
          </div>

        </div><!--Fim da subtab ORDENS DE SERVIÇO-->


        <!-- ==================== SUB-ABA 5: ORIENTAÇÕES E INFORMAÇÕES GERAIS ==================== -->
        <div class="subtab" id="sub-gerais">
          <div class="card">
            <h2>5. ORIENTAÇÕES E INFORMAÇÕES GERAIS</h2>
          </div>

          <!-- 2.6 FRO Emitido -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="froemitido">
              <span>5.1 MATERIAIS A BORDO</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-froemitido">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Formulário de Registro de Ocorrência.</p>
                <!-- IMPLEMENTAÇÃO FUTURA -->
              </div>
            </div>
          </div>
          <!-- 5.1 Novas Orientações -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="novasorient">
              <span>5.2 NOVAS ORIENTAÇÕES</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-novasorient">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Novas orientações para a equipe.</p>
                <!-- IMPLEMENTAÇÃO FUTURA -->
              </div>
            </div>
          </div>

          <!-- 5.2 Informações da Embarcação -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="infoemb">
              <span>5.3 INFORMAÇÕES DA EMBARCAÇÃO</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-infoemb">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Informações específicas da embarcação.</p>
                <!-- IMPLEMENTAÇÃO FUTURA -->
              </div>
            </div>
          </div>

          <!-- 5.3 Informações Gerais -->
          <div class="accordion-item">
            <div class="accordion-header" data-target="infogerais">
              <span>5.4 INFORMAÇÕES GERAIS</span>
              <span class="toggle">▼</span>
            </div>
            <div class="accordion-content" id="acc-infogerais">
              <div class="col">
                <p style="margin-bottom:12px; color:#666;">Informações gerais relevantes.</p>
                <!-- IMPLEMENTAÇÃO FUTURA -->
              </div>
            </div>
          </div>

        </div><!--Fim da subtab ORIENTAÇÕES E INFORMAÇÕES GERAIS-->




        <!-- MODAL DE VISUALIZAÇÃO DE INFORME -->
        <div id="modalVisualizarInforme" class="modal-overlay">
          <div class="modal-content">
            <div class="modal-header">
              <h2 style="margin:0;">Visualizar Informe de Anomalia</h2>
              <button class="modal-close" onclick="AnomSMSModule.fecharModal()">&times;</button>
            </div>
            <div class="modal-body" id="modalInformeConteudo">
              <!-- Conteúdo será inserido via JavaScript -->
            </div>
          </div>
        </div>


        <!-- ========== MODAL DETALHES MATERIAL - COMPLETO ========== -->
        <div id="modalDetalhesMaterial" class="modal hidden"
          style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); display:none; align-items:center; justify-content:center; z-index:1000;">
          <div class="modal-content"
            style="max-width:900px; background:#fff; border-radius:10px; padding:20px; max-height:90vh; overflow-y:auto; position:relative;">
            <span class="close" id="closeDetalhesMaterial">&times;</span>
            <h2 style="color:#0b7a66;">DETALHES DO MATERIAL</h2>

            <div class="modal-body">

              <!-- Embarcação -->
              <div class="col">
                <label>Embarcação</label>
                <input id="det_barco" type="text" readonly style="width:400px; background:#f5f5f5;">
              </div>

              <!-- Descrição e Identificação -->
              <div style="display:flex; gap:15px; flex-wrap:wrap;">
                <div class="col" style="flex:1 1 300px;">
                  <label>Descrição do Material</label>
                  <input id="det_desc" type="text" readonly style="width:100%; background:#f5f5f5;">
                </div>
                <div class="col" style="flex:1 1 200px;">
                  <label>Identificação/N.Série</label>
                  <input id="det_ident" type="text" readonly style="width:100%; background:#f5f5f5;">
                </div>
              </div>

              <!-- Peso e Dimensões -->
              <div style="display:flex; gap:15px; flex-wrap:wrap;">
                <div class="col" style="flex:1 1 150px;">
                  <label>Peso (kg)</label>
                  <input id="det_peso" type="text" readonly style="width:100%; background:#f5f5f5;">
                </div>
                <div class="col" style="flex:1 1 150px;">
                  <label>Altura (m)</label>
                  <input id="det_altura" type="text" readonly style="width:100%; background:#f5f5f5;">
                </div>
                <div class="col" style="flex:1 1 150px;">
                  <label>Largura (m)</label>
                  <input id="det_largura" type="text" readonly style="width:100%; background:#f5f5f5;">
                </div>
                <div class="col" style="flex:1 1 150px;">
                  <label>Comprimento (m)</label>
                  <input id="det_compr" type="text" readonly style="width:100%; background:#f5f5f5;">
                </div>
              </div>

              <!-- Responsável -->
              <div class="col">
                <label>Responsável pelo Material</label>
                <input id="det_resp" type="text" readonly style="width:300px; background:#f5f5f5;">
              </div>

              <!-- Dados de Embarque -->
              <h3 style="color:#0b7a66; margin-top:20px; margin-bottom:10px;">Informações de Embarque</h3>

              <div style="display:flex; gap:15px; flex-wrap:wrap;">
                <div class="col" style="flex:1 1 200px;">
                  <label>Data Prevista Embarque</label>
                  <input id="det_data_prev" type="text" readonly style="width:100%; background:#f5f5f5;">
                </div>
                <div class="col" style="flex:1 1 200px;">
                  <label>Nº RT</label>
                  <input id="det_rt" type="text" readonly style="width:100%; background:#f5f5f5;">
                </div>
                <div class="col" style="flex:1 1 200px;">
                  <label>Ordem de Serviço</label>
                  <input id="det_os" type="text" readonly style="width:100%; background:#f5f5f5;">
                </div>
                <div class="col" style="flex:1 1 200px;">
                  <label>Meio de Recebimento</label>
                  <input id="det_meio_rec" type="text" readonly style="width:100%; background:#f5f5f5;">
                </div>
              </div>

              <!-- Material em Contentor -->
              <div class="col" style="margin-top:15px;">
                <label>Material em Contentor?</label>
                <input id="det_cont_bordo" type="text" readonly style="width:200px; background:#f5f5f5;">
              </div>

              <!-- Informações do Contentor (Condicional) -->
              <div id="det_campos_contentor" style="display:none;">
                <h3 style="color:#0b7a66; margin-top:20px; margin-bottom:10px;">Informações do Contentor</h3>

                <div style="display:flex; gap:15px; flex-wrap:wrap;">
                  <div class="col" style="flex:1 1 200px;">
                    <label>Descrição do Contentor</label>
                    <input id="det_desc_cont" type="text" readonly style="width:100%; background:#f5f5f5;">
                  </div>
                  <div class="col" style="flex:1 1 200px;">
                    <label>Identificação do Contentor</label>
                    <input id="det_id_cont" type="text" readonly style="width:100%; background:#f5f5f5;">
                  </div>
                </div>

                <div style="display:flex; gap:15px; flex-wrap:wrap;">
                  <div class="col" style="flex:1 1 200px;">
                    <label>Responsável pelo Contentor</label>
                    <input id="det_resp_cont" type="text" readonly style="width:100%; background:#f5f5f5;">
                  </div>
                  <div class="col" style="flex:1 1 200px;">
                    <label>Nº Certificado</label>
                    <input id="det_cert_cont" type="text" readonly style="width:100%; background:#f5f5f5;">
                  </div>
                  <div class="col" style="flex:1 1 200px;">
                    <label>Validade Certificado</label>
                    <input id="det_val_cont" type="text" readonly style="width:100%; background:#f5f5f5;">
                  </div>
                </div>
              </div>

              <!-- Observações -->
              <div class="col" style="margin-top:15px;">
                <label>Observações</label>
                <textarea id="det_obs" readonly rows="3"
                  style="width:100%; resize:vertical; background:#f5f5f5;"></textarea>
              </div>

              <!-- Status -->
              <div class="col" style="margin-top:15px;">
                <label>Status do Material</label>
                <input id="det_status" type="text" readonly style="width:100%; max-width:400px; background:#f5f5f5;">
              </div>

            </div>

            <!-- Botão Fechar -->
            <div class="modal-footer" style="display:flex; gap:10px; justify-content:flex-end; margin-top:20px;">
              <button id="btnFecharDetalhes" class="btn ghost">Fechar</button>
            </div>

          </div>
        </div>






      </div>
    </section>

    <div id="modalNovaPS" class="modal hidden" aria-hidden="true">
      <div class="modal-content">
        <h3>Selecionar embarcação</h3>
        <div class="field">
          <label for="selEmbNova">Embarcação</label>
          <select id="selEmbNova">
            <option value="">— selecione —</option>
          </select>
        </div>
        <div class="btns" style="margin-top:8px">
          <button id="btnModalNovaConfirmar" class="btn" disabled>Confirmar</button>
          <button id="btnModalNovaCancelar" class="btn secondary" type="button">Cancelar</button>
        </div>
        <div id="msgModalNovaPS" class="msg-erro"></div>
      </div>
    </div>
  </main>

  <script src="/static/js/auth.js"></script>
  <script src="/static/js/anom-sms.js?v=2"></script>
  <script src="/static/js/passagens.js"></script>
  <script src="/static/js/troca-turma.js"></script>
  <script src="/static/js/manut-prev.js"></script>
  <script src="/static/js/abast.js"></script>
  <script src="/static/js/insp-norm.js"></script>
  <script src="/static/js/insp-petr.js"></script>
  <script src="/static/js/emb-equip.js"></script>
  <script src="/static/js/mob-desm.js"></script>
  <script src="/static/js/emb-mat-ps.js"></script>
  <script src="/static/js/des-mat-ps.js"></script>
  <script src="/static/js/invmat.js"></script>
  <script src="/static/js/app.js"></script>
  <script src="/static/js/assun-pend-contr.js"></script>

</body>

</html>